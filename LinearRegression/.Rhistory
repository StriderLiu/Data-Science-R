data <- read.csv(file = "bank-data.csv",head=TRUE,sep=",")
test2 <- as.data.frame(lapply(data,function(x) if(is.character(x)|is.factor(x)) gsub("YES",1,x) else x))
test2 <- as.data.frame(lapply(test2,function(x) if(is.character(x)|is.factor(x)) gsub("NO",0,x) else x))
test2 <- as.data.frame(lapply(test2,function(x) if(is.character(x)|is.factor(x)) gsub("MALE",1,x) else x))
test2 <- as.data.frame(lapply(test2,function(x) if(is.character(x)|is.factor(x)) gsub("FE1",0,x) else x))
test2 <- as.data.frame(lapply(test2,function(x) if(is.character(x)|is.factor(x)) gsub("INNER_CITY",1,x) else x))
test2 <- as.data.frame(lapply(test2,function(x) if(is.character(x)|is.factor(x)) gsub("TOWN",2,x) else x))
test2 <- as.data.frame(lapply(test2,function(x) if(is.character(x)|is.factor(x)) gsub("SUBURBAN",3,x) else x))
test2 <- as.data.frame(lapply(test2,function(x) if(is.character(x)|is.factor(x)) gsub("RURAL",4,x) else x))
prepared_data = test2[,2:12]
m = as.matrix(prepared_data)
prepared_data <- matrix(M, ncol = ncol(prepared_data), dimnames = NULL)
prepared_data <- matrix(m, ncol = ncol(prepared_data), dimnames = NULL)
prepared_data <- as.numeric(prepared_data)
num_data <- apply(prepared_data, 1,as.numeric)
num_data <- t(num_data)
#data normalization
z_scores <- scale(num_data, center = TRUE,scale = TRUE)
library(NbClust)
set.seed(Sys.time())
nc <- NbClust(z_scores, min.nc=2, max.nc=20, method="kmeans")
table(nc$Best.n[1,])
barplot(table(nc$Best.n[1,]),
xlab="Numer of Clusters", ylab="Number of Criteria",
main="Number of Clusters Chosen by 26 Criteria")
k_result <- kmeans(z_scores,iter.max = 15,centers = 2)
